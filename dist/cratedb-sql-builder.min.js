!function(){"use strict";function e(e){return"string"==typeof e?`'${e}'`:e}function n(e){return"string"==typeof e?e.replace(/'/g,"''"):e}var t={get(e){let n=`SELECT ${e.fields||"*"} FROM ${e.table}`;return e.where&&(n+=" WHERE "+e.where),n},insert(e){const n=Object.keys(e.doc).map(n=>({key:n,value:a(e.doc[n])}));return`INSERT INTO ${e.table}\n      (${n.map(e=>e.key).join()})\n      VALUES (${n.map(e=>e.value).join()})\n    `},update(t){const a=[];for(const o of Object.keys(t.doc))if("object"!=typeof t.doc[o])a.push(`${o}=${e(n(t.doc[o]))}`);else for(const r of Object.keys(t.doc[o]))a.push(`${o}['${r}']=${e(n(t.doc[o][r]))}`);return`\n      UPDATE ${t.table}\n      SET ${a.join()}\n      WHERE id = '${t.id}'\n    `},deleteRow:e=>`DELETE FROM ${e.table} WHERE id = '${e.id}'`,arrayFieldPush:e=>`\n      UPDATE ${e.table}\n      SET ${e.doc.columnName} =\n      array_cat(${e.doc.columnName}, ${e.doc.value})\n      WHERE id = '${e.id}'\n    `,arrayFieldDelete:e=>`\n      UPDATE ${e.table}\n      SET ${e.doc.columnName} =\n      array_difference(${e.doc.columnName}, ${e.doc.value})\n      WHERE id = '${e.id}'\n    `,createTable:e=>`create table ${e.table} (\n            ${Object.keys(e.fields).map(n=>"primaryKey"===n?`primary key (${e.fields[n]})`:`${n} ${e.fields[n]}`).join(",\n")}\n        )`,alterTable:e=>`ALTER TABLE ${e.table} ADD COLUMN ${e.newField.fieldName} ${e.newField.fieldType}`,dropTable:e=>"DROP TABLE IF EXISTS "+e.table};function a(t){let a;return Array.isArray(t)?`[${t.map(t=>`{${Object.keys(t).map(a=>`${a}=${e(n(t[a]))}`).join()}}`).join()}]`:"object"==typeof t?`{${Object.keys(t).map(o=>(a=n(t[o]),a=e(a),`${o}=${a}`)).join()}}`:e(n(t))}module.exports={buildSQL:e=>t[e.method](e).replace(/\s\s+/g," ").trim()+";"}}();
